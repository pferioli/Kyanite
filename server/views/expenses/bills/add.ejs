<%- include ("../../partials/header") %>

<main class="site-content">
    <div class="container" style="margin-top: 50px;">
        <form class="col s12 m6" method="post" action='/clients/new'>
            <div class="card">
                <div class="card-content">
                    <span class="card-title">Ingrese una nueva factura o comprobante</span>
                    <div class="row" style="margin-top: 20px;">
                        <div class="input-field col s9">
                            <i class="material-icons prefix">home</i>
                            <input id="client" name="client" type="text"
                                value="<%=data.client.name%> [<%=data.client.internalCode%>]" disabled />
                            <label for="name">Nombre del Barrio</label>
                        </div>
                        <div class="input-field col s3">
                            <i class="material-icons prefix">calendar_today</i>
                            <input id="client" name="client" type="text" value="" disabled />
                            <label for="name">Período de Liquidación</label>
                        </div>
                    </div>

                    <div class="row">
                        <div class="input-field col s9">
                            <select id="supplierSelect">
                                <% for(var i=0; i < data.suppliers.length; i++) { %>
                                <option value="<%=data.suppliers[i].id%>"><%= data.suppliers[i].name %></option>
                                <% } %>
                            </select>
                            <label>Nombre del Proveedor</label>
                        </div>
                        <div class="input-field col s3">
                            <input id="supplierCategory" name="supplierCategory" type="text" disabled />
                            <label for="name">Rubro</label>
                        </div>
                    </div>
                    <div class="row">
                        <div class="input-field col s4">
                            <select id="receiptTypeSelect">

                            </select>
                            <label>Tipo de Factura</label>
                        </div>
                        <div class="input-field col s4">
                            <input id="receiptNumber" name="receiptNumber" type="text" class="validate" required />
                            <label for="name">Número de Factura</label>
                        </div>
                        <div class="input-field col s4">
                            <input id="ammount" name="ammount" type="text" class="validate" required />
                            <label for="name">Importe</label>
                        </div>
                    </div>
                    <div class="row">
                        <div class="input-field col s4">
                            <select id="accountingGroupSelect"
                                onchange="populateImputations('accountingImputationSelect', this.value);">
                            </select>
                            <label>Grupo de Cuentas</label>
                        </div>
                        <div class="input-field col s4">
                            <select id="accountingImputationSelect">
                            </select>
                            <label>Imputacion Contable</label>
                        </div>
                        <div class="input-field col s2">
                            <input type="text" class="datepicker" id="dtpEmitted">
                            <label for="dtpEmitted">Emitida</label>
                        </div>
                        <div class="input-field col s2">
                            <input type="text" class="datepicker" id="dtpReceived">
                            <label for="dtpReceived">Recibida</label>

                        </div>
                    </div>


                    <div class="row">
                        <div class="input-field col s8">
                            <textarea id="comments" name="comments" class="materialize-textarea"> </textarea>
                            <label for="comments">Observaciones</label>
                        </div>
                        <div class="file-field input-field col s4">
                            <div class="btn noppading">
                                <span>Imagen</span>
                                <input type="file">
                            </div>
                            <div class="file-path-wrapper">
                                <input class="file-path validate" type="text">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card-action right-align">
                    <button type='submit' class="waves-effect waves-light btn blue" style="margin-right: 10px;"><i
                            class="material-icons right">queue</i>Siguiente</button>
                    <button type='submit' class="waves-effect waves-light btn green" style="margin-right: 10px;"><i
                            class="material-icons right">save</i>Guardar</button>
                    <a href="/expenses/paymentReceipts/<%=data.client.id%>" class="waves-effect waves-light btn red"><i
                            class="material-icons right">cancel</i>Cancelar</a>
                </div>
            </div>
        </form>
    </div>
    <div>
        <center>
            <%- include ("../../partials/alerts") %>
        </center>
</main>

<%- include ("../../partials/footer") %>

<script type="text/javascript" src="/javascripts/accountingImputations.js"></script>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        var elems = document.querySelectorAll("select");
        var instances = M.FormSelect.init(elems, {});
        elems = document.querySelectorAll('.datepicker');
        instances = M.Datepicker.init(elems, {});

        populateGroups('accountingGroupSelect');
    });

    document.getElementById('accountingGroupSelect').onchange(function () {
        console.log('onchange');
    });

    $(document).ready(function () {
        $('textarea#comments').characterCounter();

        // $('#taxCategorySelect').on('change', function () {
        //     var sel = $('#taxCategorySelect').val()
        //     $('#taxCategory').val(sel);
        // });
    });
</script>